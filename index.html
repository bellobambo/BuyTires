<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tire Search Modal</title>
    <script src="https://unpkg.com/@ant-design/icons-svg@4.2.1/dist/index.umd.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/antd-icons/3.0.1/index.css"
    />
    <style>
      :root {
        --primary-theme: #02c5f6;
        --btn-shadow: #01a2cc;
        --selection-blue: #005bc5;
        --text-gray: #666;
        --border-light: #e0e0e0;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        flex-direction: column;
      }

      .toggle-btn {
        background-color: var(--primary-theme);
        color: white;
        border: none;

        padding: 12px 24px; /* was 20px 40px */
        font-size: 15px; /* was 20px */
        font-weight: 700; /* slightly lighter */
        border-radius: 6px; /* slightly smaller radius */

        cursor: pointer;
        box-shadow: 0 4px 0 var(--btn-shadow); /* softer shadow */
        transition: all 0.2s;

        display: flex;
        align-items: center;
        gap: 10px; /* was 15px */

        text-transform: uppercase;
        letter-spacing: 0.6px; /* tighter text */
      }

      .toggle-btn:hover {
        filter: brightness(1.05);
        transform: translateY(-1px);
        box-shadow: 0 6px 0 var(--btn-shadow);
      }

      .toggle-btn:active {
        box-shadow: 0 1px 0 var(--btn-shadow);
        transform: translateY(2px);
      }

      /* Search Section */
      .search-section {
        display: none;
        width: 100%;
        max-width: 820px;
      }

      .search-section.active {
        display: block;
      }

      .toggle-btn.hidden {
        display: none;
      }

      .modal-close {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--primary-theme);
        color: white;
        border: none;
        border-radius: 50%;
        width: 35px;
        height: 35px;
        font-size: 24px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10001;
        transition: background 0.3s;
      }

      .container {
        background: #fff;
        width: 100%;
        max-width: 700px;
        padding: 25px;
        border: 1px solid var(--border-light);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        position: relative;
        border-radius: 8px;
      }

      .powered-by {
        position: absolute;
        top: 10px;
        right: 50px;
        font-size: 11px;
        color: #888;
        letter-spacing: 0.5px;
        text-transform: uppercase;
      }

      .powered-by strong {
        color: #333;
      }
      .powered-by span {
        color: var(--primary-theme);
      }

      .search-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid #cceef7;
        background-color: #f0fbfe;
        padding: 12px 25px;
        margin-bottom: 30px;
        border-radius: 4px;
      }

      .search-header h2 {
        color: var(--primary-theme);
        font-size: 19px;
        margin: 0;
        font-weight: 700;
      }

      .search-type-select {
        padding: 8px 12px;
        border: 1px solid #ccc;
        width: 200px;
        font-size: 14px;
        outline: none;
        cursor: pointer;
        background-color: #ffffff;
        color: #333;
        border-radius: 4px;
        appearance: none;
        -webkit-appearance: none;
        background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23666%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 10px top 50%;
        background-size: 10px auto;
      }

      .content-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
      }

      @media (max-width: 768px) {
        .content-grid {
          grid-template-columns: 1fr;
          gap: 20px;
        }
      }

      .form-row {
        display: flex;
        align-items: center;
        margin-bottom: 14px;
      }

      .form-row label {
        width: 110px;
        font-size: 14px;
        font-weight: 700;
        color: #444;
        flex-shrink: 0;
      }

      .asterisk {
        color: #cc0000;
        margin-left: 2px;
      }
      .dotted-label {
        border-bottom: 1px dotted #666;
        display: inline-block;
        line-height: 1;
      }

      .form-row select {
        width: 100%;
        padding: 9px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
        color: #333;
        background: #fff;
      }

      .searchable-select {
        position: relative;
        width: 100%;
      }

      .search-input {
        width: 100%;
        padding: 9px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 10;
        background: white;
      }

      .search-input.active {
        display: block;
      }

      .dropdown-options {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        max-height: 200px;
        overflow-y: auto;
        background: white;
        border: 1px solid #ccc;
        border-top: none;
        border-radius: 0 0 4px 4px;
        display: none;
        z-index: 100;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .dropdown-options.active {
        display: block;
      }
      .dropdown-option {
        padding: 8px 12px;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .dropdown-option:hover {
        background-color: #f0f0f0;
      }

      .vehicle-preview {
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      /* Style for the Tire Size Image */
      .tire-size-img {
        max-width: 100%;
        height: auto;
        margin-bottom: 15px;
        display: none; /* Hidden by default */
        border-radius: 4px;
      }

      .vehicle-name {
        font-weight: 700;
        font-size: 14px;
        color: #222;
        margin-top: 10px;
      }
      .vehicle-specs {
        font-size: 10px;
        color: #777;
        margin-top: 4px;
        letter-spacing: 0.3px;
      }

      .search-btn {
        grid-column: span 2;
        background-color: var(--primary-theme);
        color: white;
        border: none;

        padding: 10px 16px; /* slightly smaller */
        font-size: 14px; /* reduced font size */
        font-weight: 700;
        width: 210px; /* enough for one line */
        overflow: visible;

        border-radius: 3px;
        margin: 25px auto 0;
        cursor: pointer;

        box-shadow: 0 3px 0 var(--btn-shadow);

        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;

        white-space: nowrap; /* ðŸ”¥ prevents line break */
      }

      .search-btn svg {
        width: 15px;
        height: 15px;
        display: block; /* removes inline clipping */
        overflow: visible; /* ensures full render */
        flex-shrink: 0;
      }

      .search-btn .anticon {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .search-btn:active {
        box-shadow: 0 1px 0 var(--btn-shadow);
        transform: translateY(3px);
      }

      .select-wrapper {
        position: relative;
        width: 100%;
      }

      .clear-btn {
        position: absolute;
        right: 28px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        font-size: 16px;
        color: #999;
        cursor: pointer;
        display: none;
        z-index: 11;
        padding: 4px;
        border-radius: 50%;
        width: 20px;
        height: 20px;
      }

      .clear-btn.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <button class="toggle-btn" id="button1">
      <span>Shop Now</span>
    </button>

    <div class="search-section" id="searchSection">
      <div class="container">
        <button class="modal-close" id="closeModal">Ã—</button>
        <div class="powered-by">
          POWERED BY <strong>TIRE<span>CONNECT</span></strong>
        </div>

        <div class="search-header">
          <h2>HOW WOULD YOU LIKE TO SEARCH?</h2>
          <select class="search-type-select" id="searchTypeSelect">
            <option value="" disabled selected hidden>
              Select Search Type
            </option>
            <option value="size">By Tire Size</option>
            <option value="vehicle">By Vehicle</option>
          </select>
        </div>

        <div class="content-grid">
          <div class="form-side">
            <div class="form-row">
              <label>Year <span class="asterisk">*</span></label>
              <div class="select-wrapper">
                <select id="yearSelect">
                  <option value="">Select Year</option>
                </select>
                <button class="clear-btn" id="clearYear">Ã—</button>
              </div>
            </div>
            <div class="form-row">
              <label>Make <span class="asterisk">*</span></label>
              <div class="select-wrapper">
                <select id="makeSelect">
                  <option value="">Select Make</option>
                </select>
                <button class="clear-btn" id="clearMake">Ã—</button>
              </div>
            </div>
            <div class="form-row">
              <label>Model <span class="asterisk">*</span></label>
              <div class="searchable-select">
                <select id="modelSelect">
                  <option value="">Select Model</option>
                </select>
                <input
                  type="text"
                  class="search-input"
                  id="modelSearch"
                  placeholder="Search..."
                />
                <div class="dropdown-options" id="modelDropdown"></div>
                <button class="clear-btn" id="clearModel">Ã—</button>
              </div>
            </div>
            <div class="form-row">
              <label>Trim <span class="asterisk">*</span></label>
              <div class="searchable-select">
                <select id="trimSelect">
                  <option value="">Select Trim</option>
                </select>
                <input
                  type="text"
                  class="search-input"
                  id="trimSearch"
                  placeholder="Search..."
                />
                <div class="dropdown-options" id="trimDropdown"></div>
                <button class="clear-btn" id="clearTrim">Ã—</button>
              </div>
            </div>
            <div class="form-row">
              <label
                ><span class="dotted-label">Tire Size</span>
                <span class="asterisk">*</span></label
              >
              <div class="searchable-select">
                <select id="tireSizeSelect">
                  <option value="">Select Tire Size</option>
                </select>
                <input
                  type="text"
                  class="search-input"
                  id="tireSizeSearch"
                  placeholder="Search..."
                />
                <div class="dropdown-options" id="tireSizeDropdown"></div>
                <button class="clear-btn" id="clearTireSize">Ã—</button>
              </div>
            </div>
            <div class="form-row">
              <label>Season <span class="asterisk">*</span></label>
              <div class="select-wrapper">
                <select id="seasonSelect">
                  <option>All Tires</option>
                  <option>Summer</option>
                  <option>Winter</option>
                  <option>All-Season</option>
                </select>
                <button class="clear-btn" id="clearSeason">Ã—</button>
              </div>
            </div>
          </div>

          <div class="vehicle-preview">
            <img
              id="tireSizeImage"
              class="tire-size-img"
              src="https://2et52mjd63.ufs.sh/f/hoSaFx8MSm05SSV5tPvoLmWE7YJkMGnFZPwK1ICaSBxhTsv0"
              alt="Tire Size Guide"
            />
            <div class="vehicle-name" id="vehicleName">Select your vehicle</div>
            <div class="vehicle-specs" id="vehicleSpecs">
              Choose year, make, model, and trim
            </div>
          </div>

          <button class="search-btn" id="searchBtn">
            <span class="anticon">
              <svg
                viewBox="64 64 896 896"
                focusable="false"
                fill="currentColor"
                width="20px"
                height="20px"
                aria-hidden="true"
              >
                <path
                  d="M909.6 854.5L641.4 586.3C690.7 525.5 720 448.2 720 364c0-196.6-159.4-356-356-356S8 167.4 8 364s159.4 356 356 356c84.2 0 161.5-29.3 222.3-78.6l268.2 268.2c9.2 9.2 24.3 9.2 33.5 0l34.1-34.1c11.5-11.5 11.5-30.1.1-41.6zM364 640c-152.4 0-276-123.6-276-276s123.6-276 276-276 276 123.6 276 276-123.6 276-276 276z"
                ></path>
              </svg>
            </span>
            FIND YOUR TIRES NOW
          </button>
        </div>
      </div>
    </div>

    <script>
      const vehicleData = {
        Acura: {
          models: ["MDX", "RDX", "TLX", "Integra"],
          trims: {
            MDX: ["Base", "Technology", "A-Spec", "Advance"],
            RDX: ["Base", "Technology", "A-Spec"],
            TLX: ["Base", "Technology", "Type S"],
            Integra: ["Base", "A-Spec", "A-Spec Technology"],
          },
          tireSizes: {
            MDX: ["255/55R19", "255/50R20"],
            RDX: ["235/55R19", "255/45R20"],
            TLX: ["235/50R18", "255/35R20"],
            Integra: ["215/50R17", "235/40R18"],
          },
        },
        "Alfa Romeo": {
          models: ["Giulia", "Stelvio", "Tonale"],
          trims: {
            Giulia: ["Sprint", "Ti", "Veloce", "Quadrifoglio"],
            Stelvio: ["Sprint", "Ti", "Veloce"],
            Tonale: ["Ti", "Veloce"],
          },
          tireSizes: {
            Giulia: ["225/45R18", "225/40R19"],
            Stelvio: ["235/60R18", "255/45R20"],
            Tonale: ["235/45R19", "235/40R20"],
          },
        },
        Audi: {
          models: ["A4", "Q5", "A3", "Q7", "A6"],
          trims: {
            A4: ["Premium", "Premium Plus", "Prestige"],
            Q5: ["Premium", "Premium Plus", "Prestige"],
            A3: ["Premium", "Premium Plus"],
            Q7: ["Premium", "Premium Plus", "Prestige"],
          },
          tireSizes: {
            A4: ["245/40R18", "245/35R19"],
            Q5: ["235/60R18", "255/45R20"],
            A3: ["225/45R17", "225/40R18"],
            Q7: ["255/55R19", "285/45R20"],
          },
        },
        BMW: {
          models: ["3 Series", "5 Series", "X3", "X5", "X7"],
          trims: {
            "3 Series": ["330i", "M340i", "330e"],
            "5 Series": ["530i", "540i", "M550i"],
            X3: ["sDrive30i", "xDrive30i", "M40i"],
            X5: ["sDrive40i", "xDrive45e", "M50i"],
          },
          tireSizes: {
            "3 Series": ["225/45R18", "225/40R19"],
            "5 Series": ["245/45R18", "245/40R19"],
            X3: ["245/50R19", "245/45R20"],
            X5: ["265/50R19", "275/45R20"],
          },
        },
        Chevrolet: {
          models: ["Silverado 1500", "Equinox", "Tahoe", "Malibu", "Colorado"],
          trims: {
            "Silverado 1500": ["WT", "Custom", "LT", "RST", "High Country"],
            Equinox: ["LS", "LT", "RS", "Premier"],
            Tahoe: ["LS", "LT", "Z71", "Premier", "High Country"],
            Malibu: ["LS", "RS", "LT"],
          },
          tireSizes: {
            "Silverado 1500": ["265/70R17", "275/60R20"],
            Equinox: ["225/65R17", "235/50R19"],
            Tahoe: ["265/65R18", "275/50R22"],
            Malibu: ["205/65R16", "245/45R18"],
          },
        },
        Hyundai: {
          models: ["Elantra", "Sonata", "Tucson", "Santa Fe", "Palisade"],
          trims: {
            Elantra: ["SE", "SEL", "Limited", "N Line"],
            Sonata: ["SE", "SEL", "Limited", "N Line"],
            Tucson: ["SE", "SEL", "XRT", "Limited"],
            Palisade: ["SE", "SEL", "Limited", "Calligraphy"],
          },
          tireSizes: {
            Elantra: ["195/65R15", "225/45R17"],
            Sonata: ["205/65R16", "235/45R18"],
            Tucson: ["225/65R17", "235/55R19"],
            Palisade: ["245/60R18", "245/50R20"],
          },
        },
        Jeep: {
          models: [
            "Wrangler",
            "Grand Cherokee",
            "Cherokee",
            "Compass",
            "Gladiator",
          ],
          trims: {
            Wrangler: ["Sport", "Sahara", "Rubicon", "Willys"],
            "Grand Cherokee": ["Laredo", "Limited", "Overland", "Summit"],
            Compass: ["Sport", "Latitude", "Limited", "Trailhawk"],
            Gladiator: ["Sport", "Overland", "Rubicon", "Mojave"],
          },
          tireSizes: {
            Wrangler: ["245/75R17", "285/70R17", "255/70R18"],
            "Grand Cherokee": ["245/70R17", "265/50R20"],
            Compass: ["215/65R16", "225/55R18"],
            Gladiator: ["245/75R17", "285/70R17"],
          },
        },
        Kia: {
          models: ["Sportage", "Sorento", "Telluride", "Forte", "Soul"],
          trims: {
            Sportage: ["LX", "EX", "SX", "X-Line"],
            Sorento: ["LX", "S", "EX", "SX"],
            Telluride: ["LX", "S", "EX", "SX"],
            Forte: ["FE", "LXS", "GT-Line", "GT"],
          },
          tireSizes: {
            Sportage: ["235/65R17", "235/55R19"],
            Sorento: ["235/65R17", "235/55R19"],
            Telluride: ["245/60R18", "245/50R20"],
            Forte: ["195/65R15", "225/45R17"],
          },
        },
        Lexus: {
          models: ["RX", "NX", "ES", "IS", "GX"],
          trims: {
            RX: ["350", "350h", "500h F Sport"],
            NX: ["250", "350", "350h", "450h+"],
            ES: ["250", "350", "300h"],
            IS: ["300", "350 F Sport", "500"],
          },
          tireSizes: {
            RX: ["235/65R18", "235/50R21"],
            NX: ["235/60R18", "235/50R20"],
            ES: ["215/55R17", "235/45R18"],
            IS: ["235/45R18", "235/40R19"],
          },
        },
        "Mercedes-Benz": {
          models: ["C-Class", "E-Class", "GLC", "GLE", "S-Class"],
          trims: {
            "C-Class": ["C300", "AMG C43", "AMG C63"],
            GLC: ["GLC300", "AMG GLC43"],
            GLE: ["GLE350", "GLE450", "GLE53"],
          },
          tireSizes: {
            "C-Class": ["225/50R17", "225/45R18"],
            GLC: ["235/60R18", "235/55R19"],
            GLE: ["255/50R19", "275/50R20"],
          },
        },
        Nissan: {
          models: ["Altima", "Rogue", "Sentra", "Frontier", "Pathfinder"],
          trims: {
            Altima: ["S", "SV", "SR", "SL", "Platinum"],
            Rogue: ["S", "SV", "SL", "Platinum"],
            Sentra: ["S", "SV", "SR"],
            Frontier: ["S", "SV", "PRO-X", "PRO-4X"],
          },
          tireSizes: {
            Altima: ["215/60R16", "235/40R19"],
            Rogue: ["225/65R17", "235/55R19"],
            Sentra: ["205/60R16", "215/50R17"],
            Frontier: ["265/70R16", "265/65R17"],
          },
        },
        Porsche: {
          models: ["911", "Cayenne", "Macan", "Taycan", "Panamera"],
          trims: {
            911: ["Carrera", "Targa", "Turbo", "GT3"],
            Cayenne: ["Base", "S", "GTS", "Turbo"],
            Macan: ["Base", "S", "GTS"],
          },
          tireSizes: {
            911: ["235/40R19", "245/35R20"],
            Cayenne: ["255/55R19", "285/40R21"],
            Macan: ["235/60R18", "265/45R20"],
          },
        },
        Tesla: {
          models: ["Model 3", "Model Y", "Model S", "Model X"],
          trims: {
            "Model 3": ["RWD", "Long Range", "Performance"],
            "Model Y": ["Long Range", "Performance"],
            "Model S": ["Long Range", "Plaid"],
            "Model X": ["Long Range", "Plaid"],
          },
          tireSizes: {
            "Model 3": ["235/45R18", "235/40R19"],
            "Model Y": ["255/45R19", "255/40R20"],
            "Model S": ["255/45R19", "285/30R21"],
            "Model X": ["265/45R20", "265/35R22"],
          },
        },
        Volkswagen: {
          models: ["Jetta", "Tiguan", "Atlas", "Golf", "ID.4"],
          trims: {
            Jetta: ["S", "Sport", "SE", "SEL", "GLI"],
            Tiguan: ["S", "SE", "SEL R-Line"],
            Atlas: ["SE", "SEL", "SEL Premium"],
            "ID.4": ["Standard", "Pro", "Pro S"],
          },
          tireSizes: {
            Jetta: ["205/60R16", "225/45R18"],
            Tiguan: ["215/65R17", "255/40R20"],
            Atlas: ["245/60R18", "255/50R20"],
            "ID.4": ["235/55R19", "235/50R20"],
          },
        },
        Toyota: {
          models: [
            "RAV4",
            "Camry",
            "Tacoma",
            "Highlander",
            "Corolla",
            "4Runner",
            "Tundra",
            "Prius",
          ],
          trims: {
            RAV4: ["LE", "XLE", "Adventure", "Limited", "TRD Off-Road"],
            Camry: ["LE", "SE", "XLE", "XSE", "TRD"],
            Tacoma: ["SR", "SR5", "TRD Sport", "TRD Off-Road", "Limited"],
            Highlander: ["L", "LE", "XLE", "Limited", "Platinum"],
            Corolla: ["L", "LE", "SE", "XLE", "XSE"],
            "4Runner": ["SR5", "TRD Off-Road", "TRD Pro", "Limited"],
            Tundra: ["SR", "SR5", "Limited", "Platinum", "TRD Pro"],
            Prius: ["LE", "XLE", "Limited"],
          },
          tireSizes: {
            RAV4: ["225/65R17", "235/55R19", "225/60R18"],
            Camry: ["205/65R16", "235/45R18", "215/55R17"],
            Tacoma: ["265/70R16", "265/65R17", "265/70R17"],
            Highlander: ["245/60R18", "235/55R20"],
            Corolla: ["195/65R15", "205/55R16", "225/40R18"],
            "4Runner": ["265/70R17", "275/5520"],
            Tundra: ["275/65R18", "275/55R20"],
            Prius: ["195/65R15", "215/45R17"],
          },
        },
        Honda: {
          models: ["Civic", "Accord", "CR-V", "Pilot", "HR-V", "Odyssey"],
          trims: {
            Civic: ["LX", "Sport", "EX", "Touring"],
            Accord: ["LX", "Sport", "EX-L", "Touring"],
            "CR-V": ["LX", "EX", "EX-L", "Touring"],
            Pilot: ["LX", "EX", "EX-L", "Touring", "Elite"],
            "HR-V": ["LX", "Sport", "EX-L"],
            Odyssey: ["LX", "EX", "EX-L", "Touring", "Elite"],
          },
          tireSizes: {
            Civic: ["215/55R16", "235/40R18", "215/50R17"],
            Accord: ["225/50R17", "235/45R18", "235/40R19"],
            "CR-V": ["235/60R18", "235/55R19"],
            Pilot: ["245/60R18", "245/50R20"],
            "HR-V": ["215/55R17", "215/50R18"],
            Odyssey: ["235/60R18", "235/55R19"],
          },
        },
        Ford: {
          models: ["F-150", "Escape", "Explorer", "Mustang", "Edge", "Bronco"],
          trims: {
            "F-150": [
              "XL",
              "XLT",
              "Lariat",
              "King Ranch",
              "Platinum",
              "Limited",
            ],
            Escape: ["S", "SE", "SEL", "Titanium"],
            Explorer: ["Base", "XLT", "Limited", "ST", "Platinum"],
            Mustang: ["EcoBoost", "GT", "Mach 1"],
            Edge: ["SE", "SEL", "ST", "Titanium"],
            Bronco: [
              "Base",
              "Big Bend",
              "Black Diamond",
              "Outer Banks",
              "Wildtrak",
            ],
          },
          tireSizes: {
            "F-150": ["275/65R18", "275/55R20", "265/70R17"],
            Escape: ["225/60R18", "225/55R19"],
            Explorer: ["255/55R20", "265/45R21"],
            Mustang: ["235/55R17", "255/40R19", "275/40R19"],
            Edge: ["245/60R18", "245/50R20"],
            Bronco: ["255/70R16", "285/70R17", "315/70R17"],
          },
        },
      };

      const els = {
        year: document.getElementById("yearSelect"),
        make: document.getElementById("makeSelect"),
        model: document.getElementById("modelSelect"),
        trim: document.getElementById("trimSelect"),
        tireSize: document.getElementById("tireSizeSelect"),
        season: document.getElementById("seasonSelect"),
        searchType: document.getElementById("searchTypeSelect"),
        tireImage: document.getElementById("tireSizeImage"),
        modelSearch: document.getElementById("modelSearch"),
        trimSearch: document.getElementById("trimSearch"),
        tireSizeSearch: document.getElementById("tireSizeSearch"),
        modelDropdown: document.getElementById("modelDropdown"),
        trimDropdown: document.getElementById("trimDropdown"),
        tireSizeDropdown: document.getElementById("tireSizeDropdown"),
        vehicleName: document.getElementById("vehicleName"),
        vehicleSpecs: document.getElementById("vehicleSpecs"),
        searchBtn: document.getElementById("searchBtn"),
      };

      // Handle "By Tire Size" selection
      els.searchType.addEventListener("change", function () {
        if (this.value === "size") {
          els.tireImage.style.display = "block";
          els.vehicleName.style.display = "none";
          els.vehicleSpecs.style.display = "none";
        } else {
          els.tireImage.style.display = "none";
          els.vehicleName.style.display = "block";
          els.vehicleSpecs.style.display = "block";
        }
      });

      // Modal Logic
      const toggleBtn = document.getElementById("button1");
      const searchSection = document.getElementById("searchSection");
      const closeModal = document.getElementById("closeModal");

      toggleBtn.addEventListener("click", () => {
        toggleBtn.classList.add("hidden");
        searchSection.classList.add("active");
      });

      closeModal.addEventListener("click", () => {
        searchSection.classList.remove("active");
        toggleBtn.classList.remove("hidden");
      });

      // Populate Years
      const currentYear = new Date().getFullYear();
      for (let year = currentYear; year >= 1948; year--) {
        const opt = document.createElement("option");
        opt.value = year;
        opt.textContent = year;
        els.year.appendChild(opt);
      }

      // Populate Makes
      Object.keys(vehicleData)
        .sort()
        .forEach((make) => {
          const opt = document.createElement("option");
          opt.value = make;
          opt.textContent = make;
          els.make.appendChild(opt);
        });

      function setupSearchableSelect(selectEl, searchEl, dropdownEl, options) {
        let currentOptions = options || [];
        selectEl.addEventListener("click", () => {
          if (currentOptions.length > 0) {
            searchEl.classList.add("active");
            searchEl.focus();
            showDropdown(currentOptions);
          }
        });

        searchEl.addEventListener("input", (e) => {
          const query = e.target.value.toLowerCase();
          const filtered = currentOptions.filter((opt) =>
            opt.toLowerCase().includes(query)
          );
          showDropdown(filtered, query);
        });

        searchEl.addEventListener("blur", () => {
          setTimeout(() => {
            searchEl.classList.remove("active");
            dropdownEl.classList.remove("active");
          }, 200);
        });

        function showDropdown(opts, query = "") {
          dropdownEl.innerHTML = "";
          if (opts.length === 0 && query) {
            const createEl = document.createElement("div");
            createEl.className = "dropdown-option";
            createEl.textContent = `Custom: "${query}"`;
            createEl.onclick = () => selectOption(query, true);
            dropdownEl.appendChild(createEl);
          } else {
            opts.forEach((opt) => {
              const optEl = document.createElement("div");
              optEl.className = "dropdown-option";
              optEl.textContent = opt;
              optEl.onclick = () => selectOption(opt, false);
              dropdownEl.appendChild(optEl);
            });
          }
          dropdownEl.classList.add("active");
        }

        function selectOption(value, isCustom) {
          searchEl.value = "";
          if (isCustom) {
            const opt = document.createElement("option");
            opt.value = value;
            opt.textContent = value;
            selectEl.appendChild(opt);
          }
          selectEl.value = value;
          searchEl.classList.remove("active");
          dropdownEl.classList.remove("active");
          selectEl.dispatchEvent(new Event("change"));
        }

        return {
          updateOptions: (newOpts) => {
            currentOptions = newOpts;
            selectEl.innerHTML = '<option value="">Select...</option>';
            newOpts.forEach((opt) => {
              const optEl = document.createElement("option");
              optEl.value = opt;
              optEl.textContent = opt;
              selectEl.appendChild(optEl);
            });
          },
          reset: () => {
            selectEl.value = "";
            searchEl.value = "";
          },
        };
      }

      const modelSearchable = setupSearchableSelect(
        els.model,
        els.modelSearch,
        els.modelDropdown,
        []
      );
      const trimSearchable = setupSearchableSelect(
        els.trim,
        els.trimSearch,
        els.trimDropdown,
        []
      );
      const tireSizeSearchable = setupSearchableSelect(
        els.tireSize,
        els.tireSizeSearch,
        els.tireSizeDropdown,
        []
      );

      els.make.addEventListener("change", () => {
        const make = els.make.value;
        if (make && vehicleData[make])
          modelSearchable.updateOptions(vehicleData[make].models);
        else modelSearchable.reset();
        trimSearchable.reset();
        tireSizeSearchable.reset();
        updateVehiclePreview();
      });

      els.model.addEventListener("change", () => {
        const make = els.make.value;
        const model = els.model.value;
        if (make && model && vehicleData[make]?.trims[model])
          trimSearchable.updateOptions(vehicleData[make].trims[model]);
        else trimSearchable.reset();
        tireSizeSearchable.reset();
        updateVehiclePreview();
      });

      els.trim.addEventListener("change", () => {
        const make = els.make.value,
          model = els.model.value;
        if (make && model && vehicleData[make]?.tireSizes[model])
          tireSizeSearchable.updateOptions(vehicleData[make].tireSizes[model]);
        updateVehiclePreview();
      });

      els.year.addEventListener("change", updateVehiclePreview);
      els.tireSize.addEventListener("change", updateVehiclePreview);

      function updateVehiclePreview() {
        const year = els.year.value,
          make = els.make.value,
          model = els.model.value,
          trim = els.trim.value;
        // Only update text if search type is NOT "tire size"
        if (els.searchType.value !== "size") {
          if (year && make && model && trim) {
            els.vehicleName.textContent = `${year} ${make} ${model}`;
            els.vehicleSpecs.textContent = `${trim} â€¢ Ready to find tires`;
          } else {
            els.vehicleName.textContent = "Select your vehicle";
            els.vehicleSpecs.textContent = "Choose year, make, model, and trim";
          }
        }
      }

      document.querySelectorAll(".clear-btn").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          e.stopPropagation();
          const selectEl = e.target.parentElement.querySelector("select");
          if (selectEl) {
            selectEl.value = "";
            selectEl.dispatchEvent(new Event("change"));
          }
        });
      });

      [els.year, els.make, els.season].forEach((el) => {
        el.addEventListener("change", function () {
          const clearBtn = this.parentElement.querySelector(".clear-btn");
          if (clearBtn) clearBtn.classList.toggle("show", this.value !== "");
        });
      });

      els.searchBtn.addEventListener("click", () => {
        alert("Search initiated! Check console for data.");
      });
    </script>
  </body>
</html>
